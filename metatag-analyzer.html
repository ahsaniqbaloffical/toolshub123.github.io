<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meta Tag Analyzer | Toolshub123</title>
  <meta name="description" content="Analyze your website meta tags for SEO optimization. Check title, description, keywords, and more.">
  <link rel="stylesheet" href="meta-tag-tool.css">
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="icon" href="logo.png" type="image/png">
</head>
<body id="page-body">

  <header>
    <img src="logo.png" alt="Toolshub123 Logo" class="logo">
    <nav class="header-nav">
      <a href="index.html">Home</a>
      <a href="SEO%20tools.html" class="active">SEO Tools</a>
      <a href="finance%20tools.html">Finance Tools</a>
      <a href="utilitytools.html">Utility Tools</a>
      <a href="health%20tools.html">Health Tools</a>
      <button class="dark-mode-toggle" id="dark-mode-toggle">üåô Dark Mode</button>
    </nav>
  </header>

  <section class="seo-hero">
    <div class="hero-content">
      <h1>Meta Tag Analyzer</h1>
      <p>Check your website‚Äôs meta tags for SEO optimization. Instantly analyze titles, descriptions, and keywords.</p>
    </div>
  </section>

  <main class="seo-container">
    <div class="tool-card">
      <h2>Analyze Your Meta Tags</h2>
      <p style="margin-bottom: 20px;">Paste your HTML code below and click "Analyze" to extract and review meta tags.</p>

      <textarea id="htmlInput" placeholder="Paste your HTML code here..." class="tool-textarea"></textarea>

      <button onclick="analyzeMetaTags()" class="tool-btn-main">Analyze Tags</button>

      <div id="results" class="results-container" style="display:none;">
        <h3 class="results-title">Analysis Results</h3>
        
        <div id="social-img-preview" class="social-preview-box" style="margin: 20px 0; padding: 15px; background: rgba(0,0,0,0.03); border-radius: 8px;"></div>

        <div class="serp-section">
          <h4>Search Engine Previews</h4>
          <div class="serp-preview google">
            <p id="googleTitle" class="serp-title">‚Äî</p>
            <p id="googleUrl" class="serp-url">‚Äî</p>
            <p id="googleDescription" class="serp-description">‚Äî</p>
          </div>
        </div>

        <div class="data-grid">
          <div class="data-item"><strong>Title:</strong> <span id="titleResult">‚Äî</span></div>
          <div class="data-item"><strong>Title Length:</strong> <span id="titleLength">‚Äî</span></div>
          <div class="data-item"><strong>Meta Description:</strong> <span id="descriptionResult">‚Äî</span></div>
          <div class="data-item"><strong>Description Length:</strong> <span id="descriptionLength">‚Äî</span></div>
          <div class="data-item"><strong>Duplicate Tags:</strong> <span id="duplicateResult">‚Äî</span></div>
          <div class="data-item"><strong>Heading Structure:</strong> <span id="headingResult">‚Äî</span></div>
        </div>

        <h4 class="sub-results-title">Open Graph & Social</h4>
        <div class="data-grid">
           <div class="data-item"><strong>OG Title:</strong> <span id="ogTitleResult">‚Äî</span></div>
           <div class="data-item"><strong>Twitter Card:</strong> <span id="twitterCardResult">‚Äî</span></div>
        </div>

        <h4 class="sub-results-title">Recommendations</h4>
        <ul id="recommendations" class="rec-list" style="list-style: none; padding: 0;"></ul>

        <button onclick="downloadReport()" class="tool-btn-secondary" style="margin-top:20px;">Download CSV Report</button>
      </div>
    </div>

    </main>

  <footer>
    <p>&copy; 2026 Toolshub123 | Built with ‚ù§Ô∏è by Ahsan</p>
     <p style="margin-top: 10px;">
      <a href="PrivacyPolicy.html">Privacy Policy</a> |
      <a href="about.html">About</a> |
      <a href="contact.html">Contact</a>
    </p>
  </footer>

  <script>
  // --- Dark Mode Logic ---
  const darkToggle = document.getElementById('dark-mode-toggle');
  const body = document.getElementById('page-body');
  if (localStorage.getItem('theme') === 'dark') { body.classList.add('dark-mode'); darkToggle.textContent = '‚òÄÔ∏è Light Mode'; }
  darkToggle.addEventListener('click', () => {
    body.classList.toggle('dark-mode');
    const isDark = body.classList.contains('dark-mode');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
    darkToggle.textContent = isDark ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
  });

  // --- Helper Functions ---
  function getPixelWidth(text, font = "16px Arial") {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    ctx.font = font;
    return ctx.measureText(text).width;
  }
  function set(id, val) { const el = document.getElementById(id); if (el) el.innerText = val; }
  function setHTML(id, html) { const el = document.getElementById(id); if (el) el.innerHTML = html; }

  function analyzeMetaTags() {
    const input = document.getElementById("htmlInput").value.trim();
    if (!input) { alert("Please paste HTML code first."); return; }
    
    const doc = new DOMParser().parseFromString(input, "text/html");
    const recs = [];

    // 1. DATA EXTRACTION
    const title = doc.querySelector("title")?.innerText || "Not found";
    const description = doc.querySelector("meta[name='description']")?.getAttribute("content") || "Not found";
    const h1Text = doc.querySelector("h1")?.innerText || "";
    const ogTitle = doc.querySelector("meta[property='og:title']")?.getAttribute("content") || "Not found";
    const twitterCard = doc.querySelector("meta[name='twitter:card']")?.getAttribute("content") || "Not found";
    const ogImage = doc.querySelector("meta[property='og:image']")?.getAttribute("content") || "";
    const twitterImage = doc.querySelector("meta[name='twitter:image']")?.getAttribute("content") || "";
    const canonical = doc.querySelector("link[rel='canonical']")?.getAttribute("href") || "Not found";

    // 2. PIXEL CALCULATIONS
    const titlePx = title === "Not found" ? 0 : getPixelWidth(title, "600 18px Arial");
    const descPx = description === "Not found" ? 0 : getPixelWidth(description, "400 14px Arial");
    
    // 3. SOCIAL IMAGE PREVIEW
    const previewImg = ogImage || twitterImage;
    if(previewImg) {
        setHTML("social-img-preview", `<h4>Social Sharing Thumbnail</h4><img src="${previewImg}" style="max-width:100%; max-height:300px; border-radius:8px; margin-top:10px; border:1px solid #ddd;">`);
    } else {
        setHTML("social-img-preview", `<p style="color:orange;">‚ö†Ô∏è No Social Image (OG/Twitter) detected.</p>`);
    }

    // 4. RECOMMENDATIONS & CHECKS
    if (title !== "Not found" && h1Text !== "") {
        const titleWords = title.toLowerCase().split(/\s+/);
        const match = titleWords.some(word => word.length > 3 && h1Text.toLowerCase().includes(word));
        if (!match) recs.push({type: 'warn', msg: "‚ö†Ô∏è Title and H1 do not share main keywords."});
    }

    if (title === "Not found") recs.push({type: 'err', msg: "‚ùå Missing Title Tag."});
    else if (titlePx > 600) recs.push({type: 'err', msg: `‚ùå Title is too long (${Math.round(titlePx)}px).`});

    if (description === "Not found") recs.push({type: 'err', msg: "‚ùå Missing Meta Description."});
    if (doc.querySelectorAll("h1").length > 1) recs.push({type: 'err', msg: "‚ùå Multiple H1 tags detected."});

    // 5. UPDATE UI
    set("titleResult", title);
    setHTML("titleLength", `${title.length} chars (${Math.round(titlePx)}px)`);
    set("descriptionResult", description);
    set("ogTitleResult", ogTitle);
    set("twitterCardResult", twitterCard);
    set("duplicateResult", doc.querySelectorAll("title").length > 1 ? "Yes" : "No");
    set("headingResult", `H1: ${doc.querySelectorAll("h1").length}, H2: ${doc.querySelectorAll("h2").length}`);
    
    set("googleTitle", title);
    set("googleDescription", description);
    set("googleUrl", canonical === "Not found" ? "https://your-site.com" : canonical);

    const recList = document.getElementById("recommendations");
    recList.innerHTML = "";
    recs.forEach(r => {
      const li = document.createElement("li");
      li.innerText = r.msg;
      li.style.color = r.type === 'err' ? '#ff4d4d' : '#ffa500';
      li.style.fontWeight = '600';
      recList.appendChild(li);
    });

    document.getElementById("results").style.display = "block";
    
    // Global data for CSV
    window.__metaReport = { title, description, canonical, recommendations: recs.map(r => r.msg).join(" | ") };
  }

  // FIXED: Added missing Download Function
  function downloadReport() {
    const data = window.__metaReport;
    if (!data) return alert("Analyze a page first.");
    const csvContent = "data:text/csv;charset=utf-8,Field,Value\n" 
      + `Title,"${data.title}"\nDescription,"${data.description}"\nRecommendations,"${data.recommendations}"`;
    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", "seo_report.csv");
    document.body.appendChild(link);
    link.click();
  }
</script>
</body>
</html>
